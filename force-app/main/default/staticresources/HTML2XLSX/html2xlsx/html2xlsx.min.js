!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t=t||self).html2xlsx=e()}(this,function(){"use strict";function t(t){return function(t){try{return t instanceof HTMLElement}catch(e){return"object"==typeof t&&1===t.nodeType&&"object"==typeof t.style&&"object"==typeof t.ownerDocument}}(t)?t.style:""}function e(t){const e=o(t);return e>0?72*e/96:12}function o(t){if(!t)return 0;const e=t.match(/([.\d]+)pt/i);if(e&&2===e.length)return 96*parseFloat(e[1],10)/72;const o=t.match(/([.\d]+)em/i);if(o&&2===o.length)return 16*parseFloat(o[1],10);const r=t.match(/([.\d]+)px/i);if(r&&2===r.length)return parseFloat(r[1],10);const n=t.match(/([.\d]+)%/i);return n&&2===n.length?parseFloat(n[1],10)/100*16:0}function r(t){const e=t.match(/^rgba?[\s+]?\([\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?/i);if(null!=e)return(e&&4===e.length?"FF"+("0"+parseInt(e[1],10).toString(16)).slice(-2)+("0"+parseInt(e[2],10).toString(16)).slice(-2)+("0"+parseInt(e[3],10).toString(16)).slice(-2):"").toUpperCase();return t.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,function(t,e,o,r){return"#"+e+e+o+o+r+r}).replace("#","FF").toUpperCase()}function n(t,e){let n=t[`border-${e}-color`],l=t[`border-${e}-style`],c=t[`border-${e}-width`];return n?(c=o(c))<=0?null:(n=r(n),"dashed"===l||"dotted"===l||"double"===l?{style:l,color:n}:(l="thin",c>=3&&c<5&&(l="medium"),c>=5&&(l="thick"),{style:l,color:n})):null}return function(o,l,c={}){try{var i=document.implementation.createDocumentType("html","-//W3C//DTD XHTML 1.0 Strict//EN","http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd");const c=document.implementation.createDocument("http://www.w3.org/1999/xhtml","html",i),a=new xlsx.File;c.documentElement.innerHTML=o,$(c).inliner(),$("table",c).each((o,l)=>{const c=$(l).attr("name")||`Sheet${o+1}`,i=a.addSheet(c),s=[],d=[];$("tr",l).each((o,l)=>{void 0===d[o]&&(d[o]=0);let c=20;$("th, td",l).each((l,a)=>{const f=parseInt($(a).attr("rowspan"),10)||1,u=parseInt($(a).attr("colspan"),10)||1;for(let t=0;t<f;t++)for(let e=0;e<u;e++)i.cell(o+t,d[o]+e);const h=t($(a)[0]),m=e(h.fontSize);if(h.height){const t=e(h.height);t>c&&(c=t/f)}if(h.width){s[l]||(s[l]=10);const t=e(h.width)/m;s[l]<t&&(s[l]=t/u)}const p=new xlsx.Style;p.font.color=r(h.color||"#000"),p.font.size=m,p.font.name=h.fontFamily||"Verdana",p.font.bold="bold"===h.fontWeight,p.font.italic="italic"===h.fontStyle,p.font.underline="underline"===h.textDecoration;const b=h.backgroundColor;b&&(p.fill.patternType="solid",p.fill.fgColor=r(b));const g=n(h,"left");g&&(p.border.left=g.style,p.border.leftColor=g.color);const y=n(h,"right");y&&(p.border.right=y.style,p.border.rightColor=y.color);const w=n(h,"top");w&&(p.border.top=w.style,p.border.topColor=w.color);const x=n(h,"bottom");x&&(p.border.bottom=x.style,p.border.bottomColor=x.color);const D={left:"left",right:"right",center:"center",justify:"justify"};h.textAlign&&D[h.textAlign]&&(p.align.h=D[h.textAlign]);const C={top:"top",bottom:"bottom",middle:"center"};h.verticalAlign&&C[h.verticalAlign]&&(p.align.v=C[h.verticalAlign]);const F=i.cell(o,d[o]),T=$(a).text().trim();switch(($(a).attr("type")||$(a).attr("data-type")||"").toLowerCase()){case"number":F.setNumber(T);break;case"bool":F.setBool("true"===T||"1"===T);break;case"formula":F.setFormula(T);break;case"date":F.setDate(moment(T).toDate());break;case"datetime":F.setDateTime(moment(T).toDate());break;default:F.value=T}F.style=p,f>1&&(F.vMerge=f-1),u>1&&(F.hMerge=u-1);for(let t=0;t<f;t++)void 0===d[o+t]&&(d[o+t]=0),d[o+t]+=u}),i.rows[o].setHeightCM(.03528*c)});for(let t=0;t<s.length;t++){const e=s[t];e&&(i.col(t).width=e)}}),l(null,a)}catch(t){return l(t)}}});