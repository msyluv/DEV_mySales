/*! cafe note v2.3.27 | Copyright 2014, S-Core, Inc. All Right Reserved. */
!function(a,b){"use strict";function c(a,b){var c,d,f=a.length,g=[];for(c=0;c<f;c++){if(d=e[a[c]],!d)throw"Can not find a dependency module: "+a[c];g.push(d)}b.apply(null,g)}function d(a,b,d){if("string"!=typeof a)throw"invalid definition, module id must be defined";if("[object Array]"!==Object.prototype.toString.call(b))throw"Dependencies must be not null";if("[object Function]"!==Object.prototype.toString.call(d))throw"Implement function must be defined";c(b,function(){e[a]=d.apply(null,arguments)})}var e;a=a||window,e=a.Cafe&&a.Cafe.getModules?a.Cafe.getModules():{},d.amd=!0,cafe.pluginManager.add("typo2kr",[],function(a){function b(b,d){var e,f,g,h,i,j,k=a.pluginUtils,l="";for(d=d?d:"",i=b.split(/[\u0020|\u000a]{2,}/),e=0;e<i.length;e++){if(g=i[e],j=g.split(/\s/),j.length<2)k.isMatchedLinkScheme(d+g)||(g=c(g)),l+=g,d=g;else{for(f=0;f<j.length;f++)h=j[f],k.isMatchedLinkScheme(d+h)||(h=c(h)),l+=h,f<j.length-1&&(l+="Â ");d=h}e<i.length-1&&(l+=" ")}return{text:l,lastText:d}}function c(a){return a.replace(C,function(a,b,c,d){return String.fromCharCode(588*w.indexOf(b)+28*x[c]+y[d]+44032)})}function d(a){a.remove?a.remove():a.removeNode&&a.removeNode()}function e(a){var b,c,d,e,f=[];return b=a.startContainer,c=a.startOffset,d=a.endContainer,e=a.endOffset,f=a.collapsed?m.getWord(b,c):m.getTextNodeListByRange(b,c,d,e),g(f,a)}function f(a,b){var c,d,e=[];for(b?(e=m.getTextNodeListByRange(a,0,b,-1),c=e.length,e.length>0&&e[c-1]===b&&e.pop(),c=e.length,e.length>0&&"BR"===e[c-1].nodeName&&e.pop()):e=m.getTextNodeListByRange(a,0,a,-1),c=e.length,d=c-1;d>0;d--)if("BR"===e[d].nodeName){e=e.slice(d+1,c);break}return g(e),!0}function g(a,c){var e,f,g,h,i,j,k;for(j=a[0],k=a[0],e=1,f=a.length;e<f;e++)i=a[e],i&&(1===k.nodeType?k=i:1!==i.nodeType&&k.parentNode===i.parentNode?(k.data+=i.data,d(i)):(g=b(k.data,g?g.lastText:""),k.data!==g.text&&(k.data=g.text,h=!0),k=i));return k&&(k.data&&(g=b(k.data,g?g.lastText:""),k.data!==g.text&&(k.data=g.text,h=!0)),c&&(j&&!c.collapsed?l.setRange(j,0,k,k.length):l.setRange(k,k.length,k,k.length))),h}function h(a,b){var c=b.isCarriageReturn,d=b.isPressShift,e=b.lineElement,h=b.target,i=[];return c?d?f(e,h):f(e):(i=m.getWord(a.startContainer,a.startOffset,!0),g(i,a)),!0}function i(a){return e(a)}function j(){o&&o.option("pressed",!q),p&&p.option("disabled",!q),a.toggleMenuItem(t+".auto",!q),a.disableMenuItem(t+".manual",!q),q=!q}function k(b){var c,d,e;if(o&&o.option("pressed")){if(e=l.getCursorPosition(),b){if(r?(d=e.lineElement,c=s(e.node)[0],d===c&&(c=d.lastChild)):d=e.lineElement.previousSibling,""===d.textContent)return}else d=e.lineElement,c=s(e.node)[0];a.execCommand(t+".auto",{isCarriageReturn:b,isPressShift:r,lineElement:d,target:c})}}var l,m,n,o,p,q,r,s=a.$,t="typo2kr",u=a.os.mac?"Command+F2":"Ctrl+F2",v=a.editorManager.editorConstants.CommandTypes,w="rRseEfaqQtTdwWczxvg",x={k:0,o:1,i:2,O:3,j:4,p:5,u:6,P:7,h:8,hk:9,ho:10,hl:11,y:12,n:13,nj:14,np:15,nl:16,b:17,m:18,ml:19,l:20},y={"":0,r:1,R:2,rt:3,s:4,sw:5,sg:6,e:7,f:8,fr:9,fa:10,fq:11,ft:12,fx:13,fv:14,fg:15,a:16,q:17,qt:18,t:19,T:20,d:21,w:22,c:23,z:24,x:25,v:26,g:27},z="["+w+"]",A="hk|ho|hl|nj|np|nl|ml|k|o|i|O|j|p|u|P|h|y|n|b|m|l",B="rt|sw|sg|fr|fa|fq|ft|fx|fv|fg|qt|r|R|s|e|f|a|q|t|T|d|w|c|z|x|v|g|",C=new RegExp("("+z+")("+A+")(("+B+")(?=("+z+")("+A+"))|("+B+"))","g");a.addButton(t+".auto",{label:a.getText(t+".auto"),icons:{primary:"typo-to-korean-auto"},iconOnly:!0,click:function(){j()}}),a.addButton(t+".manual",{label:a.getText(t+".manual"),icons:{primary:"typo-to-korean"},iconOnly:!0,click:function(){a.execCommand(t)}}),a.addMenuItem(t,{icon:"typo-to-korean-properties",text:a.getText(t),menuItems:[t+".auto",t+".manual"]}),a.addMenuItem(t+".auto",{icon:"typo-to-korean-auto",text:a.getText(t+".auto"),click:function(){j()}}),a.addMenuItem(t+".manual",{icon:"typo-to-korean",text:a.getText(t+".manual"),shortcut:u,click:function(){a.execCommand(t)}}),a.addCommand({command:t,type:v.CUSTOM_COMMAND_RANGE,shortcut:u,action:i}),a.addCommand({command:t+".auto",type:v.CUSTOM_COMMAND_RANGE,action:h}),a.on("editorcreate",function(){var b=s.ui.keyCode;n=a.getBody(),o=a.getToolButton(t+".auto"),p=a.getToolButton(t+".manual"),l=a.selectionManager,m=a.selectionUtils,s(n).on("keypress.cafe",function(c){c.keyCode===b.SPACE?k():c.keyCode===b.ENTER&&(r=a.browser.safari?c.ctrlKey:c.shiftKey)}).on("keyup.cafe",function(a){a.keyCode===b.ENTER&&k(!0)})}),a.one("editorcreate",function(){var b=a.pluginUtils,c=a.constants.ButtonTypes;b.addInitialWidgetState(t+".auto",!1,c.TOGGLE),b.addInitialWidgetState(t+".manual",!1,c.ENABLED)}),a.addFinalTask(function(){t=null,u=null,l=null,m=null,n=null,o=null,p=null,q=null,r=null,v=null,w=null,x=null,y=null,z=null,A=null,B=null,C=null,s=null})}),a.Cafe&&!a.Cafe.getModules&&(a.Cafe.getModules=function(){return e})}(this);