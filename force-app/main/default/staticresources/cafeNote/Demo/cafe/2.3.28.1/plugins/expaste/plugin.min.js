/*! cafe note v2.3.28.1 | Copyright 2014, S-Core, Inc. All Right Reserved. */
!function(a,b){"use strict";function c(a,b){var c,d,f=a.length,g=[];for(c=0;c<f;c++){if(d=e[a[c]],!d)throw"Can not find a dependency module: "+a[c];g.push(d)}b.apply(null,g)}function d(a,b,d){if("string"!=typeof a)throw"invalid definition, module id must be defined";if("[object Array]"!==Object.prototype.toString.call(b))throw"Dependencies must be not null";if("[object Function]"!==Object.prototype.toString.call(d))throw"Implement function must be defined";c(b,function(){e[a]=d.apply(null,arguments)})}var e;a=a||window,e=a.Cafe&&a.Cafe.getModules?a.Cafe.getModules():{},d.amd=!0,d("plugins/expaste/Utility",["jqueryCafe","utilities/EditorConstants","utilities/StyleParser","utilities/CSSParser","utilities/UnitConverter"],function(a,c,d,e,f){function g(b,c,d){var e,f,g,h,i,j,k,l={},m=[],n=0;l=a.extend(l,b);for(e in c)if(!(b[e]||(f=ea[e],b[f]||Array.isArray(f)&&(b[f[0]]||b[f[1]]))))if(Array.isArray(da[e])){for(n=0,m=[],i=da[e].length,g=0;g<i;g++)m[g]=da[e][g],b[m[g]]&&n++;if(0===n)l[e]=c[e];else{if(n===i)continue;for(g=0;g<i;g++){for(j=m[g].split("-"),k=j.length,h=1;h<k;h++)j[h]&&(j[0]+=j[h].charAt(0).toUpperCase()+j[h].substring(1,j[h].length));b[m[g]]?l[m[g]]=d[j[0]]:l[m[g]]=c[e]}delete l[e]}}else l[e]=c[e];return l}function h(a,b,c,e){var f,h,i,j,k,l;try{h=a.find(b)}catch(a){return}for(i=h.length,j=0;j<i;j++)f=h.eq(j),k=d.parse(f.attr("style"),e),l=g(k,c,f[0].style),l=d.serialize(l),f.attr("style",l)}function i(a,b,c){var d,e,f,g,h;if(c=c||Y,d=c[a]||null){for(e=d.length,g={},f=0;f<e;f++)h=b[d[f]],h&&(g[d[f]]=h);b=g}return b}function j(a,b){var c,d,e=a.length;for(c=0;c<e;c++)d=a[c],Y[d]=b}function k(a,b,c,d){var e,f,g,i;for(g=b.___types[c],e=0,f=g.length;e<f;e++)i=b[g[e]],h(a,g[e],i,d)}function l(a,b,c){var d,e;if(b.___types)k(a,b,"complex",c),k(a,b,"class",c),k(a,b,"tag",c);else for(d in b)e=b[d],h(a,d,e,c)}function m(a,b){var c,d,e=new RegExp("\\b"+b+"=[\\\"']([^\\\"']*)[\\\"']","gi");return d=e.exec(a),d&&d[1]&&(c=d[1]),c}function n(b,c,d,e,f,g){var h,i=[],j="border-"+c;if(b[j]?h=b[j]:b.border&&(h=b.border),!h||h.length<=0)i=["","",""];else for(i=a.trim(h).split(/\s/);i.length<3;)i.push("");return e&&(i[0]=e[d]),b[j+"-width"]&&(i[0]=b[j+"-width"]),f&&(i[1]=f[d]),b[j+"-style"]&&(i[1]=b[j+"-style"]),g&&(i[2]=g[d]),b[j+"-style"]&&(i[2]=b[j+"-color"]),i.join(" ")}function o(b){var c,d,e,f,g,h=/<body\b[^<]*(?:(?!<\/body>)<[^<]*)*<\/body>/gi,i="";if(c=b.match(h))for(d=c.length,e=0;e<d;e++)i+=c[e];else i=b;return i&&(i=a.trim(i.replace(/<\/body>/i,"").replace(/<body[^<]*>/i,""))),f=i.indexOf(Z),g=i.lastIndexOf($),i&&f!==-1&&g!==-1&&(i=i.substring(f+Z.length,g)),i}function p(a){var b,c="";return c+=q(a),c+=r(a),c+=s(a),c+=m(a,"style")||"",b=m(a,"class")||"",c.length>0&&(c='style="'+c+'"'),b&&b.length>0&&(c=c+' class="'+b+'"'),c}function q(a){var b;return b=m(a,"color"),b=b?"color: "+b+";":""}function r(a){var b;return b=m(a,"face"),b=b&&/Wingdings\s\d/i.test(b)?"font-family: '"+b+"';":b?"font-family: "+b+";":""}function s(a){var b;if(b=m(a,"size")){switch(parseInt(b,10)){case 1:b="7.5pt";break;case 2:b="9pt";break;case 3:b="12pt";break;case 4:b="13.5pt";break;case 5:b="18pt";break;case 6:b="24pt";break;default:b="36pt"}b="font-size: "+b+";"}else b="";return b}function t(a,b){var c;return c=_.parse(a,b)}function u(b){var c,d;return d=document.createDocumentFragment(),c=a("<body></body>"),c.append(a.parseHTML(b)),d.appendChild(c[0]),c}function v(a,b){return ba[a]!==b}function w(a){var b,c,d="";for(b in a)c=a[b],!/^(?:mso\-|\-webkit|-moz)/i.test(b)&&v(b,c)&&(d+=b+":"+c+";");return d}function x(a){return a=a.replace(/<!--[\s\S]+?-->/gim,""),a=a.replace(/<![\s\S]+?>/gim,"")}function y(a){return/<font face="Times New Roman"|class="?Mso|style="[^"]*\bmso-|style='[^']*\bmso-|w:WordDocument/i.test(a)||/class="OutlineElement/.test(a)||/schemas-microsoft-com\:office/.test(a)||/id="?docs\-internal\-guid\-/.test(a)}function z(a){return y(a)&&/schemas-microsoft-com\:office:excel/.test(a)}function A(a){return y(a)&&/Microsoft PowerPoint/.test(a)}function B(a){var b=a.split(/\s/),c=[b[0],b[0],b[0],b[0]];return b[1]&&(c[1]=b[1],c[3]=b[1]),b[2]&&(c[2]=b[2]),b[3]&&(c[3]=b[3]),c}function C(a){return/<colgroup\b[^>]*>/i.test(a)&&!/<\/colgroup\>/i.test(a)&&(a=a.replace(/<colgroup>(?:<col\b[^>]*>\s*)+/gi,function(a){return a+"</colgroup>"})),/<col\b[^>]*>/i.test(a)&&(a=a.replace(/<col\b[^>]*>/gi,function(a){var b,c,d="",e=a.match(/span\s*=\s*[\'\"]?(\d+)[\'\"]?/i);if(e&&e[1])for(b=parseInt(e[1],10),c=a.replace(e[0],"");b--;)d+=c;else d=a;return d})),a}function D(a){return a&&"string"==typeof a&&(a=a.replace(/<meta\b[^>]*>(<\/meta>)?/gi,""),a=a.replace(/<iframe\b[^<]*(?:(?!<\/iframe>)<[^<]*)*<\/iframe>/gi,""),a=a.replace(/<input\b[^<]*(?:(?!<\/input>)<[^<]*)*<\/input>/gi,""),a=a.replace(/<button\b[^<]*(?:(?!<\/button>)<[^<]*)*<\/button>/gi,""),a=a.replace(/<object\b[^<]*(?:(?!<\/object>)<[^<]*)*<\/object>/gi,""),a=a.replace(/<form\b[^<]*(?:(?!<\/form>)<[^<]*)*<\/form>/gi,""),a=a.replace(/lang\s*=\s*[\'\"](?:[^\'^\"])*[\'\"]/gi,""),a=a.replace(/id\s*=\s*(?:(?:\'[^\']*\')|(?:\"[^\"]*\"))/gim,""),a=a.replace(/class\s*=\s*(?:(?:\'[^\']*\')|(?:\"[^\"]*\"))/gim,""),a=a.replace(/<strong/i,"<b").replace(/<\/strong>/i,"</b>"),a=a.replace(/<em/i,"<i").replace(/<\/em>/i,"</i>")),a}function E(a,b){for(var c=a,d=b?"firstChild":"lastChild";c&&c[d];)c=c[d];return c}function F(a,b){var c;if(a)switch(a.charCodeAt(0)){case 110:c="■";break;case 119:c="◆";break;case 159:c="•";break;case 160:b&&(c="•");break;case 167:c="▪";break;case 216:c="➢";break;case 252:c="✓";break;default:c=a}return c}function G(a){var b=a.createElement("span");return b.style.border="1px dotted",b.style.height="2px",b.style.width="99%",b.style.display="block",b.style.position="relative",b.style.top="50%",b.style.transform="translateY(-50%)",b.style.pageBreakBefore="always",b.style.borderWidth="0px",b.setAttribute("unselectable","on"),b.setAttribute("data-cui-pagebreak",!0),b.setAttribute("data-cafe-filter","pagebreak"),b.contentEditable=!1,b.tabIndex="-1",b.innerHTML="&#65279;",b}function H(a){for(var b,c=a;c&&"BODY"!==c.nodeName&&(b=c.parentNode,b.firstChild===c&&b.lastChild===c);)c=b;return c===a?null:c}function I(b,c){a(b[0].childNodes).appendTo(c),c.appendTo(b)}function J(a){var b=0,c=a.length,d=0;if(!c)return b;for(;d<c;++d)b=(b<<5)-b+a.charCodeAt(d),b|=0;return b}function K(a,b,c,d){var e=d[0].nodeName;return!!/^(?:\-|widows|zoom|animation|flex|fill|flood|transition|transform|lighting-color|stop-color|color-interpolation|color-interpolation-filters)/.test(a)||(!!/^(?:auto|normal|inherit|initial|inherit|null)$/i.test(b)||("background-color"===a&&"transparent"===b||(!(!/^(border|text\-transform|float)$/i.test(a)||!/none/i.test(b))||(!("display"!==a||!/^inline$/.test(b))||(!!/^(?:br|hr)$/i.test(e)||(!("A"!==e||!/\#0000ee/i.test(b))||(!(!/(?:ul|ol)/i.test(e)||"padding-left"!==a)||("word-wrap"===a&&"break-word"===b||("text-align"===a&&"start"===b||(!(!/^(text-indent|word-spacing)$/i.test(a)||"0px"!==b)||("color"===a&&b===c?!d[0].parentNode||d[0].style.color===d[0].parentNode.style.color:b===c&&!/^(?:color|font-size|font-family)$/i.test(a))))))))))))}function L(a,b){var c,d,e=a.split(/\s+/);for(b["font-style"]="normal",b["font-weight"]="normal",b["font-variant"]="normal",b["line-height"]="normal";c=e.shift();)switch(c){case"normal":break;case"italic":case"oblique":b["font-style"]=c;break;case"small-caps":b["font-variant"]=c;break;case"bold":case"bolder":case"lighter":case"100":case"200":case"300":case"400":case"500":case"600":case"700":case"800":case"900":b["font-weight"]=c;break;default:if(!b["font-size"]){d=c.split("/"),b["font-size"]=d[0],d.length>1&&(b["line-height"]=d[1]);break}if(!b["font-family"]&&(b["font-family"]=c,e.length)){b["font-family"]+=" "+e.join(" ");break}}return b["font-family"]&&(b["font-family"]=b["font-family"].replace(/\"/g,"'")),b}function M(b,c){var d,e,f=!1;for(b=b.replace(/((?:left|right|center|top) (?:top|center|bottom)|\d+% \d+%|\d+px \d+px|(?:top|center|bottom) (?:left|right|center|top))/gi,function(a){return a.replace(" ","__")}),b=b.replace("/"," / "),b=N(b),c=c||{},c["background-color"]="transparent",c["background-image"]="none",c["background-position"]="0% 0%",c["background-size"]="auto",c["background-repeat"]="repeat",c["background-origin"]=null,c["background-clip"]=null,c["background-attachment"]="scroll",e=b.split(/\s+/);d=e.shift();)/^(?:transparent|\#[\d\w]+)$/i.test(d)?c["background-color"]=d:/^(?:none|url\s*\([^\)]+\))$/.test(d)?c["background-image"]=d:!f&&/((?:left|right|center|top)__(?:top|center|bottom)|\d+%__\d+%|\d+px__\d+px|(?:top|center|bottom)__(?:left|right|center|top))/i.test(d)?c["background-position"]=d.replace("__"," "):"/"===d?f=!0:f&&/(?:auto|contain|cover|\d+%(?:__\d+%)?|\d+px(?:__\d+px)?)/i.test(d)?c["background-size"]=d.replace("__"," "):/^(?:repeat|repeat-x|repeat-y|no-repeat)$/i.test(d)?c["background-repeat"]=d:!c["background-origin"]&&/^(?:(?:padding|border|content)-box$)/i.test(d)?c["background-origin"]=d:/^(?:(?:padding|border|content)-box$)/i.test(d)?c["background-clip"]=d:/scroll|fixed|local/i.test(d)?c["background-attachment"]=d:a.colorUtils.isColorName(d)&&(c["background-color"]=d);return delete c.background,c}function N(b){return/rgb?\s*\(/i.test(b)&&(b=b.replace(/rgb?\s?\([^\)]+\)/i,function(b){return a.colorUtils.toHEXString(b)})),b}function O(b){var c,d,e,f,g,h,i="none",j=!1;for(c=b.replace(/rgb(?:a)?\s?\([^\)]+\)/i,function(b){return j=!0,a.colorUtils.toHEXString(b)}),c=a.trim(c).split(/\s+/),h=c.length;d=c.shift();)switch(d){case"none":case"hidden":case"dotted":case"dashed":case"solid":case"double":case"groove":case"ridge":case"inset":case"outset":i=d;break;default:if(/^\#[0-9A-F]+/i.test(d)){f=d;break}if(a.colorUtils.toHEXString(d)){f=d;break}/^\d+(?:\.\d+)*px$/i.test(d)&&(e=d)}return g=j||2!==h?e+" "+i+" "+(f||"inherit"):e+" "+i}function P(c,d,e){var g,h,i;c.font&&(L(c.font,c),delete c.font),c.outline&&(c.outline=O(c.outline),delete c.outline),c.background&&M(c.background,c),c.border&&(c.border=O(c.border)),d.border&&(d.border=O(d.border));for(g in c){switch(c[g]||(c[g]="null"),i=c[g].replace(/\s*!important$/,""),i=N(i),h=d[g],g){case"font-family":h===aa&&(h=window.unescape(aa),h=h.replace(/[\"\']/g,""));break;case"font-size":/^13\.33(:?\d)*(:?\s)*px$/i.test(i)?i="10pt":/px$/i.test(i)&&(i=f.convertPXToPT(i)+"pt");break;case"color":/^rgb/i.test(i)&&(i=a.colorUtils.toHEXString(i));break;case"line-height":"16px"===i&&(i="1.2"),h===b&&(h="1.2")}c[g]=i,/^0$/i.test(h)&&/^0\s*(?:px|em|pt|rem)$/i.test(i)?i=i.charAt(0):/^\.\d+/i.test(h)&&(h="0"+h,d[g]=h),K(g,i,h,e)&&delete c[g]}}function Q(a,b){var c=parseFloat(a);return b=b||0,Math&&(b=Math.pow(10,b),c=Math.round(c*b)/b),c}function R(b,c){for(var d,e,f,g,h,i,j,k,l=b.find("P,LI,SPAN"),m=l.length,n=c.configs.default_line_height,o=c.configs.line_height_map,p={},q="line-height",r="font-size";m--;)e=l.eq(m),f=e[0].nodeName,"SPAN"===f?e.css(q,""):(g=e.css(q),h=e.css(r),h&&/px$/i.test(g)&&(j=parseFloat(g),i=parseFloat(h),d=f+"-"+j+"-"+i,"1.9"===n&&/^23\.\d*px$/i.test(g)?e.css(q,""):"1.2"===n&&/^14\.\d*px$/i.test(g)?e.css(q,""):p[d]||""===p[d]?(k=p[f+"-"+j+"-"+i],e.css(q,k)):Math.round&&o&&a.isNumeric(i)&&a.isNumeric(j)&&(k=Q(j)/Q(i),k=Q(10*k)/10,n===k+""?(e.css(q,""),p[f+"-"+j+"-"+i]=""):o[k+""]?(e.css(q,k),p[d]=k):o[Q(k)+""]&&(k=Q(k),n===k+""&&(k=""),e.css(q,k),p[d]=k))));p=null}function S(a,b){for(var c,e,f,g,h,i,j,k,l,m,n=a.find("[style]"),o=n.length,p={};o--;){if(j=n.eq(o),e=j[0].nodeName,f=j.attr("style"),g=J(f),c=p[g],/(?:ul)/i.test(e))for(k=j.parent("ol, ul"),m=0,l=k.length>3?3:k.length;m<l;m++)e=k[m].nodeName+" "+e;c?i=p[g]:"SPAN"===e&&j.attr("data-cui-pagebreak")?i="border: 1px dotted; height: 2px; width: 99%; display: block; position: relative; top: 50%; transform: translateY(-50%); page-break-before: always;":(f=d.parse(f,{plain:!0}),h=b.getDefaultStyle(e),P(f,h,j),i=d.serialize(f),p[g]=i),null===i||0===i.length?j.removeAttr("style"):j[0].setAttribute("style",i)}p=null}function T(a){var b,c,d=E(a,!0),e=!1;return d&&3===d.nodeType&&(b=d.parentNode,c=b.getAttribute("style"),e=/(?:wingdings|mso\-special\-format)/i.test(c)),e}function U(a){var b,c,d=a.firstChild,e=!0;if(!ca[a.nodeName])return!1;for(;d;){if(b=d.nodeType,c=d.textContent,!(1===b&&"BR"===d.nodeName||3===b&&(0===c.length||/^[\s\uFEFF\xA0]+$/.test(c)))){e=!1;break}d=d.nextSibling}return e}function V(a,b){for(var d,e,f=c.LineBlockElements,g=a,h=b?"firstChild":"lastChild";g&&!f[g.nodeName]&&(d=g.parentNode,e=d.nodeName,d.firstChild===d.lastChild&&d[h]===g&&ca[e]);)g=d;return g}function W(a,b){for(var c,d,e=b?"previousSibling":"nextSibling",f=a.parentNode,g=a[e],h=null;g&&h!==g&&(c=g.nodeType,d=g.textContent,1!==c);)3!==c||0!==d.length&&!/^[\s\uFEFF\xA0]+$/.test(d)||f.removeChild(g),h=g,g=a[e]}function X(a){var b=a.parentNode;if(b){for(;a.firstChild;)b.insertBefore(a.firstChild,a);b.removeChild(a)}}var Y={},Z="<mysingle_body>",$="</mysingle_body>",_=e,aa=c.DEFAULT_FONT_FAMILY_JS,ba={"font-weight":"normal","text-align":"left"},ca=c.toMap("span,font,strong,b,em,strike,sup,sub,u"),da={border:["border-top","border-left","border-right","border-bottom"]},ea={"border-color":"border","border-style":"border","border-width":"border","border-bottom":"border","border-left":"border","border-top":"border","border-right":"border","border-bottom-color":["border-bottom","border"],"border-bottom-style":["border-bottom","border"],"border-bottom-width":["border-bottom","border"],"border-left-color":["border-left","border"],"border-left-style":["border-left","border"],"border-left-width":["border-left","border"],"border-top-color":["border-top","border"],"border-top-style":["border-top","border"],"border-top-width":["border-top","border"],"border-right-color":["border-right","border"],"border-right-style":["border-right","border"],"border-right-width":["border-right","border"],"border-image-outset":"border-image","border-image-repeat":"border-image","border-image-slice":"border-image","border-image-source":"border-image","border-image-width":"border-image","border-top-left-radius":"border-radius","border-top-right-radius":"border-radius","border-bottom-left-radius":"border-radius","border-bottom-right-radius":"border-radius"};return j(["P","H1","H2","H3","H4","H5","H6"],["color","font-family","font-size","font-style","font-weight","line-height","margin","margin-left","margin-top","margin-bottom","margin-right","text-align","text-decoration","text-indent"]),j(["LI"],["color","font-family","font-size","font-style","font-weight","line-height","list-style-type","margin","margin-left","margin-right","margin-top","margin-bottom","text-align","text-decoration","text-indent"]),{applyStyle:l,calculateLineHeight:R,colgroupFilter:C,convertUnicodeSymbol:F,createPageBreakElem:G,extractAttrValue:m,extractBorderStyle:n,extractContent:o,extractFontStyle:p,getLeafNode:E,getLastStyleElement:V,getSingleParent:H,isMSOffice:y,isMSExcel:z,isMSPPT:A,isPPTList:T,isRemovableParent:U,parseCSS:t,parseHTML:u,purifyStyle:S,removeIEComments:x,removeBrowserStyle:w,removeSiblingEmptyTextnode:W,splitBorderStyle:B,trimContent:D,validStyle:i,unwrapNode:X,wrapElements:I}}),d("plugins/expaste/MSFormatter",["plugins/expaste/Utility","utilities/StyleParser"],function(a,b){function c(c){function d(a,b,c){var d,e;e=new RegExp("(?:^|\\s)"+b+"\\s*[^;]*(?:;|$)","i"),d=a.attr("style"),d=e.test(d)?d.replace(e,b+":"+c+";"):b+":"+c+";"+d,a.attr("style",d)}function e(a,b,c,d){var e,f,g,h;if(a)if(e=a.find(b),d)for(h=e.length;h--;)f=e.eq(h),c(f);else for(g=0,h=e.length;g<h;g++)f=e.eq(g),c(f)}function f(b){var c,d,e,f,g,h,i,j,m,n={},o=["top","right","bottom","left"],p=b[0].tagName||b[0].nodeName;if(c=b.attr("style"),d=l.parse(c),d=a.validStyle(p,d),/^(?:td|th)$/i.test(p))for(d["border-width"]&&(f=a.splitBorderStyle(d["border-width"]),delete d["border-width"]),d["border-style"]&&(e=a.splitBorderStyle(d["border-style"]),delete d["border-style"]),d["border-color"]&&(i=d["border-color"],i=i.replace(/\([^\)]*\)/gi,function(a){var b=a;return b=b.replace(/\s/g,"")}),g=a.splitBorderStyle(i),delete d["border-color"]),m=o.length,j=0;j<m;j++)h=a.extractBorderStyle(d,o[j],j,f,e,g),d["border-"+o[j]]=h;/bold/i.test(d["font-weight"])&&"B"!==p&&(delete d["font-weight"],k(b[0].childNodes).wrap(k("<b></b>"))),/italic/i.test(d["font-style"])&&"I"!==p&&(delete d["font-style"],k(b[0].childNodes).wrap(k("<i></i>"))),/line\-through/i.test(d["text-decoration"])&&"STRIKE"!==p&&(delete d["text-decoration"],k(b[0].childNodes).wrap(k("<strike></strike>"))),/underline/i.test(d["text-decoration"])&&"U"!==p&&(delete d["text-decoration"],k(b[0].childNodes).wrap(k("<u></u>"))),n=a.removeBrowserStyle(d),n?b.attr("style",n):b[0].removeAttribute("style")}function g(a){var b=/<\s*meta\s*name=(Generator|Originator)\s*content=\"Microsoft\s*(Word|Powerpoint|Excel)\s*15\"\s*>/gi.exec(a);if(!b)return!1;switch(c.isMSOfficeContent={word:!1,powerpoint:!1,excel:!1},b[2]){case"Word":c.isMSOfficeContent.word=!0;break;case"Powerpoint":c.isMSOfficeContent.powerpoint=!0;break;case"Excel":c.isMSOfficeContent.excel=!0}return!0}var h,i,j=this,k=c.$,l=b,m=!1;j.applyFormat=function(b){var j,l,n=a.isMSExcel(b),o="white-space,font-weight,font-family,color,font-size,text-decoration,background,background-color,border,border-top,border-bottom,border-left,border-right,border-collapse,height,width,text-align,vertical-align,line-height,list-style-type,font-style,margin,margin-left, margin-top,margin-bottom,text-indent,mso-ignore,padding,padding-left,padding-top,padding-bottom,padding-right";return m=c.isPluginLoaded("table"),i=a.isMSPPT(b),h={styles:o.split(","),useCompressIndent:c.configs.useCompressIndent,useCompressBorderDirection:!0,typeCheck:!0,opType:!0},c.os&&c.os.mac&&!g(b)&&c.isMSOfficeContent&&delete c.isMSOfficeContent,c.browser.ie||(l=a.parseCSS(b,h)),b=a.extractContent(b),c.browser.ie&&(h.styles=h.styles.concat(["border-width","border-color","border-style","border-left-color","border-right-color","border-top-color","border-bottom-color","border-left-style","border-right-style","border-top-style","border-bottom-style","border-left-width","border-right-width","border-top-width","border-bottom-width"]),h.useCompressBorderDirection=!1,b=b.replace(/class\s*=\s*[\'\"](?:[^\'^\"])*[\'\"]/gi,""),b=b.replace(/<font\b[^>]*>[\s\uFEFF\xA0]+<\/font>/gi," ")),b=b.replace(/<meta\b[^>]*>(<\/meta>)?/gi,""),b=b.replace(/<iframe\b[^<]*(?:(?!<\/iframe>)<[^<]*)*<\/iframe>/gi,""),b=b.replace(/<input\b[^<]*(?:(?!<\/input>)<[^<]*)*<\/input>/gi,""),b=b.replace(/<button\b[^<]*(?:(?!<\/button>)<[^<]*)*<\/button>/gi,""),b=b.replace(/<object\b[^<]*(?:(?!<\/object>)<[^<]*)*<\/object>/gi,""),b=b.replace(/<form\b[^<]*(?:(?!<\/form>)<[^<]*)*<\/form>/gi,""),b=b.replace(/<strong/i,"<b").replace(/<\/strong>/i,"</b>"),b=b.replace(/<em/i,"<i").replace(/<\/em/i,"</i"),b=a.removeIEComments(b),b=a.colgroupFilter(b),/<font\b[^>]*>/i.test(b)&&(b=b.replace(/<font\b[^>]*>/gi,function(b){var c=a.extractFontStyle(b);return"<span "+c+" >"}),b=b.replace(/<\/font>/gi,"</span>")),/<o\:p>/i.test(b)&&(b=b.replace(/<o\:p>/gi,'<span class="cafe-ms-space">'),b=b.replace(/<\/o\:p>/gi,"</span>")),b=b.replace(/<span\s{1,}style='mso-spacerun:yes[^>]*>([^<]*(?:(?!<\/span>)<[^<]*)*)<\/span>/gi,function(a,b){var c=0,d="";for(b&&(b=b.replace(/\r\n /g,""),c=b.length);c--;)d+=" ";return d}),b=b.replace(/&nbsp;/gi," "),b=b.replace(/<!--[\s\S]+?-->(?:\r\n|\n|\r)?/gim,""),b=b.replace(/<\?xml\:namespace\b[^\/]*\/>/gi,""),j=a.parseHTML(b),m?e(j,"[data-cui-selected=true]",function(a){a.removeAttr("data-cui-selected")}):(e(j,"[width]",function(a){var b=a.attr("width");d(a,"width",b+"px"),a.attr("width",null)}),e(j,"[height]",function(a){var b=a.attr("height");d(a,"height",b+"px"),a.attr("height",null)})),e(j,"[id]",function(a){var b=a[0];b&&b.removeAttribute("id")}),e(j,"[lang]",function(a){var b=a[0];b&&b.removeAttribute("lang")}),e(j,".cafe-ms-list",function(b){var d,e;c.browser.ie||(e=a.getLeafNode(b[0],!0),e&&3===e.nodeType&&(d=e.textContent,d=a.convertUnicodeSymbol(d),e.textContent=d))}),c.browser.ie&&c.browser.version>10&&e(j,"ul, ol",function(a){for(var b=a.find("> li"),c=["font-size","color","font-family"],d=c.length;d--;)b.css(c[d],"")}),e(j,".cafe-ms-space",function(b){var d,e=b.text();1===e.length&&" "===e?(d=k(a.getSingleParent(b[0])),1===d.length&&d.is("p, li, h1, h2, h3, h4, h5, h6")&&(d.children().remove(),d[0].appendChild(c.getDoc().createElement("BR")),d.removeAttr("class"))):e.length>1?b.replaceWith(b[0].childNodes):b.remove()}),e(j,"br",function(b){var d,e,f,g,h;if(f=b[0],d=f.getAttribute("style"),/line-break/gi.test(d))f.removeAttribute("style");else if(/page-break-before\s*:\s*always/gi.test(d))return e=a.createPageBreakElem(c.getDoc()),void b.parent().replaceWith(e);c.browser.ie&&(a.removeSiblingEmptyTextnode(f),a.removeSiblingEmptyTextnode(f,!0),g=a.getLastStyleElement(f),h=f.parentNode,g!==f?(b.insertAfter(g),g.parentNode.removeChild(g)):a.isRemovableParent(h)&&a.unwrapNode(h))},!0),e(j,"div",function(b){var d,e=b.find("table"),f=b[0];e.length>0?b.replaceWith(b.children()):a.isPPTList(f)&&(d=c.getDoc().createElement("p"),d.setAttribute("style",f.getAttribute("style")),k(d).append(f.childNodes),b.replaceWith(d))}),j&&l&&a.applyStyle(j,l,h),n&&e(j,"th, td",function(a){var b=a[0],d=c.selectionManager.getClosest(b,"table"),e=b.style,f=e.height,g=e.paddingTop||0,h=e.paddingBottom||0,i=e.borderTopWidth||0,j=e.borderBottom||0;f&&(f=parseInt(f,10),g=parseInt(g,10),h=parseInt(h,10),f-=g+h,"none"===e.borderStyle||"hidden"===e.borderStyle?(i=0,j=0):("none"!==e.borderTopStyle&&"hidden"!==e.borderTopStyle||(i=0),"none"!==e.borderBottomStyle&&"hidden"!==e.borderBottomStyle||(j=0)),i=parseInt(i,10),j=parseInt(j,10),0!==b.parentNode.rowIndex&&(i/=2),b.parentNode.rowIndex+b.rowSpan<d.rows.length&&(j/=2),f-=i+j,b.style.height=f+"px")}),e(j,"[class]",function(a){var b=a[0];b&&b.removeAttribute("class")}),e(j,"[style]",f),e(j,"table",function(a){var b,c,d,e,f,g,h,i,j,l,m,n,o=a[0],p=o.parentNode,q=[],r=[];if("SPAN"===p.nodeName)if("absolute"===p.style.position){for(i=k(o).find("td"),d=i.length,e=0;e<d;e++)j=i[e],parseInt(j.width)&&q.push(parseInt(j.width)),parseInt(j.height)&&r.push(parseInt(j.height));for(g=k(o).find("p"),d=g.length,e=0;e<d;e++)h=g[e],p.parentNode.insertBefore(h,p);for(b=k(o).find("img"),d=b.length,e=0;e<d;e++){for(c=b[e],m=parseInt(p.style.marginTop)?parseInt(p.style.marginTop):0,n=parseInt(p.style.marginLeft)?parseInt(p.style.marginLeft):0,f=0,j=c.parentNode;"TD"!==j.nodeName;)j=j.parentNode;for(;j.previousSibling;)j=j.previousSibling,"TD"===j.nodeName&&(f>0&&(n+=q[f-1]),f++);for(f=0,l=j.parentNode;"TR"!==l.nodeName;)l=l.parentNode;for(;l.previousSibling;)l=l.previousSibling,"TR"===l.nodeName&&(f>0&&(m+=r[f-1]),f++);c.style.position=p.style.position,c.style.marginTop=m+"px",c.style.marginLeft=n+"px",p.parentNode.insertBefore(c,p)}k(p).remove()}else k(o).unwrap()}),e(j,"img",function(a){var b,d,e,f,g,h=a[0],i=h.parentNode,j=h.getAttribute("src"),l=h.getAttribute("cafeimg");for(b=parseInt(h.style.top,10)||0,d=parseInt(h.style.left,10)||0,e=parseInt(h.style.marginTop,10)||0,f=parseInt(h.style.marginLeft,10)||0;"SPAN"===i.nodeName;)b+=parseInt(i.style.top,10)||0,d+=parseInt(i.style.left,10)||0,e+=parseInt(i.style.marginTop,10)||0,f+=parseInt(i.style.marginLeft,10)||0,"absolute"===i.style.position?(h.style.position="absolute",0!==b&&(h.style.top=b+"px"),0!==d&&(h.style.left=d+"px"),0!==e&&(h.style.marginTop=e+"px"),0!==f&&(h.style.marginLeft=f+"px"),g=parseInt(i.style.zIndex),g&&(h.style.zIndex=g),i.parentNode.insertBefore(h,i)):i.firstChild===i.lastChild&&i.parentNode.insertBefore(h,i),i.firstChild?(i.style.zIndex="",i=i.parentNode):(k(i).remove(),i=h.parentNode);return h.removeAttribute("v:shapes"),l||c.pluginUtils.isSupportImageData(j)?(a.attr("unselectable","on"),a.attr("data-cui-image")||a.attr("data-cui-media")||a.attr("data-cui-pagebreak")||a.attr("data-cui-image","true"),void(a.css("border-top-width")||a.css("border-width","0px"))):(h.setAttribute("title","No Image"),h.setAttribute("src",c.constants.NoImageData),h.setAttribute("unselectable","on"),h.setAttribute("data-cui-image","true"),void h.setAttribute("data-cui-alt-image","true"))}),e(j,"a",function(a){var b,c;b=a.attr("href"),c=a.attr("name"),(/_?(?:toc)/i.test(b)||/_?(?:toc)/i.test(c)||/range\!/i.test(c))&&a.replaceWith(a.contents())}),e(j,"del",function(a){a.remove()}),c.browser.ie||e(j,"td, th",function(a){var b,c=a.css("font-size")||"",d=a.css("font-family")||"";(c||d)&&(b=k("<span>"),c&&b.css("font-size",c),d&&b.css("font-family",d),b.append(a.contents()),a.empty().append(b))}),c.browser.webkit&&e(j,"p, h1, h2, h3, h4, h5, h6, li",function(a){0===a.text().length&&0===a.find("img, a, br").length&&(a.contents().remove(),a.append("<br>"))}),l=null,j},j.isMSPPTContent=function(){return i},j.destroy=function(){j=null,k=null,l=null,h=null,m=null}}return c}),d("plugins/expaste/Formatter",["plugins/expaste/MSFormatter","plugins/expaste/Utility"],function(a,b){function c(c){function d(){return null===g&&(g=c.selectionManager.getDefaultFilter()),g}var e=c.$,f=this,g=null,h=c.configs.enable_invalid_item_alert||!1,i=new a(c),j=!1;f.doc=c.getDoc(),f.applyFormat=function(a,f,g,i){var k,l,m,n,o,p,q,r=this;return o=c.selectionManager.getHtmlParser(),c.browser.ie&&(a=a.replace(/<font\b[^>]*>[\s\u00A0\u0009\n\u0020]+<\/font\b[^>]*>/gi,"")),/text\-decoration\-line/i.test(a)&&(a=o.replaceTextDecoration(a)),b.isMSOffice(a)?k=r.applyMSFormat(a,f):a.indexOf('data-cui-text="plain"')!==-1?(c.isMSOfficeContent&&delete c.isMSOfficeContent,k=e('<xbody data-cui-filter="true" >'+a+"</xbody>")):(c.isMSOfficeContent&&delete c.isMSOfficeContent,a=b.extractContent(a),/<font\b[^>]*>/i.test(a)&&(a=a.replace(/<font\b[^>]*>/gi,function(a){var c=b.extractFontStyle(a);return"<span "+c+" >"}),a=a.replace(/<\/font>/gi,"</span>")),(l=a.match(/<\!--StartFragment-->[^]*<\!--EndFragment-->/gi))&&(a=l[0]),a=a.replace(/<!--[\s\S]+?-->(?:\r\n|\n|\r)?/gim,"").replace(/class=\"Apple-interchange-newline\"/gi,""),a=b.colgroupFilter(a),m=d(),k=m.filter(a,!0),b.calculateLineHeight(k,c),b.purifyStyle(k,c)),q=!(!k[0].firstChild||"TABLE"!==k[0].firstChild.nodeName||k[0].children[1]),j=q,k=e(o.validDoc(k[0],null,g,i)),q&&(q=!1,p=k[0].firstChild,e(p).addClass("cui-pasted-table")),h&&(o.hasInvalidItem()||m&&m.hasInvalid())&&c.alert(c.getText("alert.parser.invaliditem")),n=k.html(),k.remove(),n},f.applyMSFormat=function(a,b){return i.applyFormat(a,b)},f.isOnlyTableContent=function(){return j},f.isMSPPTContent=function(){return i.isMSPPTContent()},f.destroy=function(){i.destroy(),e=null,f.doc=null,f=null,i=null}}return c}),d("plugins/expaste/Clipboard",["utilities/EditorConstants","plugins/expaste/Utility"],function(a,b){function c(b){function c(a){var b=document.createElement("IMG");b.onload=a,b.onerror=a,b.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNkYAAAAAYAAjCB0C8AAAAASUVORK5CYII="}function d(a,c,d){function e(a){c.items.push(a.target.result),window.__loadImage=h.result,d?(b.pluginUtils.setActionDataForImageFormatQuality({from:"expaste",callback:q,openConvertDialog:!0,setLastRangeToNull:function(){x=null}}),b.dialog("imageformatquality"),b.getDialog("imageformatquality").options.imageData=c):(B=a.target.result,G.trigger("pasteimageloaded"))}function f(){G.trigger("pasteimageloaderror")}var g,h,i,j=a.length;for(c.items=[],g=0;g<j;g++)if(i=a[g],/^image/i.test(i.type)){h=new window.FileReader,h.onload=e,h.onerror=f;try{h.readAsDataURL(i.getAsFile?i.getAsFile():i)}catch(a){G.trigger("pasteimageloaderror")}}}function e(){h(),D(v).on("paste",function(a){a.stopPropagation()}),K&&L<=9&&(v.style.display="none"),q()}function f(a){function c(){var c,d,e,f=x.getClientRects(),g={sc:x.startContainer,so:x.startOffset,ec:x.endContainer,eo:x.endOffset};c=f.length,f=0!==c?f[c-1]:null,f||x.collapsed&&(d=x.startContainer,1===d.childNodes.length&&"BR"===d.firstChild.nodeName?(0===x.startOffset?x.setEndAfter(d.firstChild):x.setStartBefore(d.firstChild),f=x.getClientRects()[0]):(e=b.getDoc().createTextNode(" "),x.insertNode(e),f=x.getClientRects()[0],D(e).remove())),a.pageX=f?f.x+f.width:0,a.pageY=f?f.y+f.height+b.getWin().scrollY:0,H.setRange(g.sc,g.so,g.ec,g.eo),x=H.getRange()}var f,g,h,i,j,k,l={};if(k=a.clipboardData||b.getDoc().dataTransfer,k&&k.types&&k.types.length>0){if(i=k.types,i.indexOf(O)>=0?(j=O,f=k.getData(O),c()):i.indexOf(P)>=0&&(j=P,f=k.getData(P)),f&&f.length>0)return l[j]=f,void q(l,a);if(i.indexOf("Files")>=0&&(g=k.items||k.files))return void d(g,l,!0);if(i.indexOf("com.microsoft.DataObject")>=0)return e(),!0;h=k.getData("Text"),h&&h.length>0&&(l[P]=h,q(l,a))}else x=null}function g(a,b){var c=a[b];return c&&c.length>0}function h(){var a,b,c=20;v||(b=F.getBoundingClientRect(),b&&(c=F.topMargin-b.top),a="position: absolute; z-index: 2; overflow: hidden; opacity: 0; top: "+c+"px; left: -999px; width: 10px; height: 10px; ",v=D("<div id='"+J+"' contenteditable='true' style='"+a+"' unselectable='on'>"+N+"</div>")[0],K&&L<=9?F.insertBefore(v,F.firstChild):F.appendChild(v),H.selectElement(v.firstChild),D(v).on("beforedeactivate focusin focusout",function(a){a.stopPropagation()})),v.focus(),H.selectElement(v.firstChild)}function i(){v&&(D(v).off().remove(),v=null)}function j(){var a;return v&&(a=v.innerHTML),a}function k(){var a,b,c,d="";if(v)for(a=D(v).contents(),c=0,b=a.length;c<b;c++)d+=D(a[c]).text()+"\n";return d}function l(a){var b=a.keyCode,c=a.metaKey||a.ctrlKey;return w=!0,c&&86===b||a.shiftKey&&45===b}function m(a){var b=a.keyCode,c=a.metaKey||a.ctrlKey;return w&&(16===b||17===b||c&&86===b||a.shiftKey&&45===b)}function n(a,c){a&&x&&(I(x),b.execCommand("pasteashtml",{range:x,contents:a,event:c}))}function o(a){a&&x&&(a=a.replace(/\r\n/g,"\n"),I(x),b.execCommand("pasteastext",{range:x,contents:a}))}function p(a){var c=D("<div></div>");return y||(y=b.getDoc().createDocumentFragment()),c.append(D(a)),y.appendChild(c[0]),a=M.getPlainText(c[0]),y.removeChild(c[0]),c=null,a}function q(a,d,e){c(function(){function c(){i(),m[O]!==N&&(x||(x=b.selectionManager.getRange()),M.deselectItem(!0),A||b.configs.paste_as_text?o(m[P]):n(m,d),C=null,B=null,x=null)}function f(a){var b={};return g(a,P)?b[P]=a[P]:g(a,O)&&(b[O]=a[O],b[P]=p(b[O])),b}function h(a){var b={};return b[P]=a[P],b[P]=b[P].replace(/\&/g,"&amp;").replace(/</g,"&lt;").replace(/\>/g,"&gt;"),b[P]='<pre data-cui-text="plain">\n'+b[P]+"</pre>",b}function l(a){function d(a){a.setAttribute("unselectable","on"),a.setAttribute("data-cui-image","true"),a.style.borderWidth="0px"}function f(){h=b.pluginUtils.convertImage(h,i),m.image=h.outerHTML,c()}var g,h,i,j=b.getDoc(),k=a.items,l=k&&k.length;for(g=0;g<l;g++)i=k[g],b.pluginUtils.isSupportImageData(i)&&(i?e?(h=j.createElement("img"),h.setAttribute("src",i),d(h),h.onload=f):(h=j.createElement("img"),h.setAttribute("src",i),d(h),m.image=h.outerHTML):(h=j.createElement("img"),h.setAttribute("src",E.NoImageData),h.setAttribute("data-cui-alt-image","true"),h.style.height=q.height+"px",h.style.width=q.width+"px",d(h),m.image=h.outerHTML))}var m={},q=E.DefaultImageSize;a?A?m=f(a):g(a,P)?m=h(a):(g(a,O)&&(m[O]=a[O]),l(a),a.hasImageAndHTML&&(m.hasImageAndHTML=!0)):A?m[P]=k():m[O]=j(),e||c()})}function r(a){K&&L<=10&&(i(),x=H.getRange().cloneRange(),h()),z=a}function s(){K&&L<=10&&c(function(){i(),x=null}),z=!1}function t(){D=null,E=null,G=null,F=null,H=null,I=null,J=null,K=null,L=null,u=null,v=null,w=null,x=null,M=null,y=null,z=null,A=null,N=null,O=null,P=null,C=null,B=null}var u,v,w,x,y,z,A,B,C,D=b.$,E=b.constants,F=b.getBody(),G=D(F),H=b.selectionManager,I=H.setSingleRange,J=a.DUMY_PASTE_ELEM,K=!!b.browser.ie,L=b.browser.version,M=b.pluginUtils,N="__init__",O="text/html",P="text/plain";return G.on("keydown.cafe",function(a){function c(a){m(a)&&!a.isDefaultPrevented()&&(w=!1,i(),I(x),x=null)}if((!b.isSpellcheckMode||!b.isSpellcheckMode())&&l(a)&&!a.isDefaultPrevented()){if(u=a.shiftKey&&86===a.keyCode,x)return void a.preventDefault();if(x=H.getRange().cloneRange(),u&&a.stopImmediatePropagation(),K&&u)return a.preventDefault(),void G.trigger("paste",a);
K&&(i(),h()),G.one("keyup",c),G.one("paste",function(){w=!1,G.off("keyup",c)})}}).on("paste.cafe",function(a){var c;if(!b.isSpellcheckMode||!b.isSpellcheckMode()){if(A=!(!z&&!u),a.isDefaultPrevented())return void i();if(x||(x=H.getRange().cloneRange()),K){if(A)return c=window.clipboardData,c&&(o(c.getData("Text")),x=null),void(u=!1);e()}else{if(!b.browser.firefox)return!!f(a.originalEvent||a);e()}}}),{startPaste:r,endPaste:s,destroy:t}}return c}),d("plugins/expaste",["plugins/expaste/Clipboard","plugins/expaste/Formatter","utilities/EditorConstants"],function(a,b,c){cafe.pluginManager.add("expaste",[],function(d){function e(a,b,c,e){var f,g,h=d.contentUtils;if(!a||!b)return a;for(f=b.parentNode;b&&f&&!w[b.nodeName];){if(c&&f.firstChild===b)g=b;else{if(c||f.lastChild!==b)break;g=b}b=f,f=b.parentNode}return g&&g!==b&&(c?h.isFormattedEmptyLine(b)?(a.setStartBefore(h.getLeafNode(b,!0)),a.setEndBefore(h.getLeafNode(b,!0))):(a.setStartBefore(g),a.setEndBefore(g)):e||(a.setStartAfter(g),a.setEndAfter(g))),a}function f(a,b,c){if(!j)return!1;try{if(j.startPaste(a),!c)return d.$(b).find("body").trigger("paste"),j.endPaste(),!0;if(b.execCommand("paste"))return d.execCommand("paste"),j.endPaste(),!0}catch(a){}return j.endPaste(),!1}function g(a){var b=d.getDoc();if(b.queryCommandSupported("paste"))if(a&&d.browser.ie){if(f(a,b,!1))return}else if(f(a,b,!0))return;d.alert(a?u:p)}function h(a,b){var e,f,g,h=c.TAB_COUNT,i="",j=d.contentUtils;for(e=b.range?b.range:a,f=b.contents,g=0;g<h;g++)i+=" ";return f=j.removeUnnecessaryUnicode(f),f=f.replace(/[\t]+/g,function(a){return a.replace(/\t/g,i)}),f=f.replace(/[ \n][ ]+/g,function(a){return a.replace(/ /g," ")}),f=f.replace(/^ /," "),e=j.insertTextByRange(f,e),d.scrollTo(e),d.uiManager.isDialogOpened()||d.focus(),!0}function i(a,b){function c(a){var b=m[a];s=b.match(/src="data:image[^"]*/g),s&&s.length>0&&(b=z.filterDataUriSrc(b,s)),b=k.applyFormat(b,null,j.cloneRange(),a===w),m[a]=z.removeUnnecessaryUnicode(b),p=k.isOnlyTableContent()}function f(a,b){var c,f,g=0,h="",i=!1;if(j.collapsed&&(q=j.startContainer,r=j.startOffset,3===q.nodeType?0===r&&e(j,q,!0,b):1===q.nodeType&&(0===r?e(j,q.childNodes[0],!0,b):r<=q.childNodes.length&&e(j,q.childNodes[r-1],!1,b))),b)z.insertElementByRange(l(a)[0],j),j=d.selectionManager.getRange();else{if(t===w)for(i=!0,c=l(a)[0].parentNode,f=c.childNodes.length-1,g;g<=f;g++)h+=c.childNodes[g].innerText,g<f&&(h+="\n");j=i?z.insertTextByRange(h,j):z.insertHtmlBlockByRange(a||m[x],j,s)}d.scrollTo(j),d.trigger("htmlpasted"),d.uiManager.isDialogOpened()||d.focus()}function g(){j=d.selectionManager.getRange().cloneRange(),o.element.off("contextmenuclose"),o.close()}function h(){o=l.ui.contextmenu({target:"#"+d.uiManager.widgets.panel_edit.getID(),autoRegistration:!1,hasInput:!1}).create(d.uiManager.getEditArea().parent())}function i(a,b,c){y.push({name:a,text:b,click:function(){"function"==typeof c&&c(),g()}}),o.element.on("contextmenuclose",function(){j=null})}var j,m,n,o,p,q,r,s,t,u=!0,v=!1,w="text/plain",y=[],z=d.contentUtils;if(j=b.range?b.range:a,m=b.contents,n=d.uiManager.getContext(),t=m[x]?x:m[w]?w:null,t&&c(t),p&&n.search(/table/)>=0&&d.isPluginLoaded("extable"))switch(h(),n){case"table.empty-cell.selected":i("nesttable",d.getText("table.menu.nesttable"),f),i("overwitecells",d.getText("table.menu.overwritecells"));break;case"table.single-cell.selected":case"table.multi-cell.selected":i("overwitecells",d.getText("table.menu.overwritecells")),v=!0}return o?(o.option("menuItems",y),o.open(b.event)):m[t]?f(m[t]):m.image?f(m.image,!0):u=!1,u}var j,k,l=d.$,m="paste",n="paste",o=d.getText("paste"),p=d.getText("paste.dialog.message"),q=d.os.mac?"Command+V":"Ctrl+V",r="pasteastext",s="paste-as-text",t=d.getText("pasteastext"),u=d.getText("pasteastext.dialog.message"),v=d.os.mac?"Command+Option+Shift+V":"Ctrl+Shift+V",w=c.LineBlockElements,x="text/html";d.addContextMenuItem(m,{icon:n,text:o,context_disable:"table.single-cell.selected table.multi-cell.selected",click:function(){g(!1)}}),d.addContextMenuItem(r,{icon:s,text:t,context_disable:"table.single-cell.selected table.multi-cell.selected",click:function(){g(!0)}}),d.addMenuItem(m,{icon:n,text:o,shortcut:q,click:function(){g(!1)}}),d.addMenuItem(r,{icon:s,text:t,shortcut:v,click:function(){g(!0)}}),d.addCommand({command:"pasteastext",type:cafe.editorConstants.CommandTypes.CUSTOM_COMMAND_RANGE,action:h}),d.addCommand({command:"pasteashtml",type:cafe.editorConstants.CommandTypes.CUSTOM_COMMAND_RANGE,action:i}),d.one("editorinitialized",function(){var c=q,e=v;d.os.mac&&(c=d.uiManager.convertMacSymbol(c),e=d.uiManager.convertMacSymbol(e)),p=p.replace(/\{0\}/,c),u=u.replace(/\{0\}/,e),j=new a(d),k=new b(d),d.pluginUtils.addInitialWidgetState(r,!1)}),d.on("tablestatechange",function(a,b){d.disableMenuItem(r,!!b.cells)}),d.addFinalTask(function(){k.destroy(),j.destroy(),v=null,q=null,j=null,k=null,m=null,n=null,o=null,p=null,r=null,s=null,t=null,u=null,w=null})})}),a.Cafe&&!a.Cafe.getModules&&(a.Cafe.getModules=function(){return e})}(this);